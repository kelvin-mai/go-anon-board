{{ template "header.tmpl" .}}

{{ $board := .title }}

<h2>Create Thread?</h2>
<form action="/api/threads/{{ $board }}" method="POST">
  <label for="create_text">Text</label>
  <input id="create_text" name="text" />
  <label for="create_password">Delete Password</label>
  <input id="create_password" type="password" name="password" />
  <button type="submit">Submit</button>
</form>

<ul>
  {{ range .threads }}
  <li>
    <div>
      <p>{{ .Text }}</p>
      <form action="/api/threads/{{ $board }}" method="POST">
        <input type="hidden" value="delete" name="_method" />
        <input type="password" name="password" />
        <input type="hidden" value="{{ .ID }}" name="id"/>
        <button type="submit">Delete</button>
      </form>
      <form action="/api/threads/{{ $board }}" method="POST">
        <input type="hidden" value="PUT" name="_method" />
        <input type="hidden" value="{{ .ID }}" name="id" />
        <button type="submit">Report</button>
      </form>
      <form action="/api/replies/{{ $board }}" method="POST">
        <input type="hidden" value="{{ .ID }}" name="thread_id" />
        <input type="text" name="text" />
        <input type="password" name="password" />
        <button type="submit">Reply</button>
      </form>
      <ul>
        {{ $thread_id := .ID }}
        {{ range .Replies}}
        <li>
          <div>
            {{ .Text }}
            {{ if ne .Text "[deleted]" }}
            <form action="/api/replies/{{ $board }}" method="POST">
              <input type="hidden" value="put" name="_method" />
              <input type="hidden" value="{{ $thread_id }}" name="thread_id" />
              <input type="hidden" value="{{ .ID }}" name="reply_id" />
              <button type="submit">Report</button>
            </form>
            <form action="/api/replies/{{ $board }}" method="POST">
              <input type="hidden" value="delete" name="_method" />
              <input type="hidden" value="{{ $thread_id }}" name="thread_id" />
              <input type="hidden" value="{{ .ID }}" name="reply_id" />
              <input type="password" name="password" />
              <button type="submit">Delete</button>
            </form>
            {{ end }}
          </div>
        </li>
        {{ end }}
      </ul>
    </div>
  </li>
  {{ end }}
</ul>

{{ template "footer.tmpl" .}}
